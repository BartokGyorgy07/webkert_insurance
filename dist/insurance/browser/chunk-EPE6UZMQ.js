import{a as N,b as F,c as $,d as B,e as V,f as j,g as z,h as Y,i as q,j as G,k as J,l as K,m as W}from"./chunk-EV65HTBM.js";import"./chunk-4Z6DYTJO.js";import{q as T}from"./chunk-U5MZNTUN.js";import"./chunk-YNJY2X3T.js";import{a as A,b as R,c as L,e as k,g as H}from"./chunk-FU5GNOX3.js";import{m as y,o as P,p as O}from"./chunk-RF2VUACT.js";import{a as Q,b as U}from"./chunk-IO52UDSH.js";import{$ as h,$a as x,Ca as I,Fa as w,Ha as m,La as s,Sb as E,Ta as i,Ua as a,Va as d,Wa as p,Xa as u,Za as b,aa as M,ab as _,kb as r,lb as g,ta as c,ub as S,vb as D,xa as v}from"./chunk-7RETW5W6.js";var f=class e{transform(t){if(!t)return"";try{let n=new Date(t);if(isNaN(n.getTime()))return t;let o=n.getFullYear(),l=String(n.getMonth()+1).padStart(2,"0"),C=String(n.getDate()).padStart(2,"0");return`${o}-${l}-${C}`}catch{return t}}static \u0275fac=function(n){return new(n||e)};static \u0275pipe=w({name:"dateFormatter",type:e,pure:!0})};function ee(e,t){e&1&&(i(0,"th",12),r(1,"Insurance Name"),a())}function te(e,t){if(e&1&&(i(0,"td",13),r(1),a()),e&2){let n=t.$implicit;c(),g(n.name)}}function ne(e,t){e&1&&(i(0,"th",12),r(1,"Expiration Date"),a())}function ie(e,t){if(e&1&&(i(0,"td",13),r(1),S(2,"dateFormatter"),a()),e&2){let n=t.$implicit;c(),g(D(2,1,n.dueDate))}}function ae(e,t){e&1&&(i(0,"th",12),r(1,"Actions"),a())}function re(e,t){if(e&1){let n=b();i(0,"td",13)(1,"button",14),x("click",function(){let l=h(n).index,C=_();return M(C.deleteInsurance(l))}),i(2,"mat-icon"),r(3,"delete"),a()()()}if(e&2){let n=_();c(),s("disabled",n.isLoading)}}function oe(e,t){e&1&&d(0,"tr",15)}function ce(e,t){e&1&&d(0,"tr",16)}function se(e,t){e&1&&(i(0,"tr",17)(1,"td",18),r(2,"No active insurances"),a()())}var X=class e{constructor(t){this.insuranceService=t}displayedColumns=["name","date","actions"];activeInsurances=[];isLoading=!1;subscription;ngOnInit(){this.loadActiveInsurances()}ngOnDestroy(){this.subscription?.unsubscribe()}loadActiveInsurances(){this.isLoading=!0,this.subscription=this.insuranceService.getActiveInsurances().subscribe({next:t=>{this.activeInsurances=t,this.isLoading=!1},error:()=>{this.activeInsurances=[],this.isLoading=!1}})}deleteInsurance(t){let n=this.activeInsurances[t];n&&confirm("Are you sure you want to delete this insurance?")&&(this.isLoading=!0,this.insuranceService.deleteInsurance(n.id).then(()=>this.loadActiveInsurances()).finally(()=>this.isLoading=!1))}clearAllInsurances(){this.activeInsurances.length!==0&&confirm("Are you sure you want to delete all active insurances?")&&(this.isLoading=!0,Promise.all(this.activeInsurances.map(t=>this.insuranceService.deleteInsurance(t.id))).then(()=>this.loadActiveInsurances()).finally(()=>this.isLoading=!1))}static \u0275fac=function(n){return new(n||e)(v(W))};static \u0275cmp=I({type:e,selectors:[["app-expired"]],decls:24,vars:4,consts:[[1,"expired-container"],[1,"spacer"],["mat-raised-button","","color","warn",3,"click","disabled"],["mat-table","",1,"mat-elevation-z2",3,"dataSource"],["matColumnDef","name"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","date"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["mat-header-cell",""],["mat-cell",""],["mat-icon-button","","color","warn","aria-label","Delete insurance",3,"click","disabled"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(n,o){n&1&&(i(0,"div",0)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),r(4,"Active Insurances"),a(),d(5,"div",1),i(6,"button",2),x("click",function(){return o.clearAllInsurances()}),i(7,"mat-icon"),r(8,"delete_sweep"),a(),r(9," Clear All "),a()(),i(10,"mat-card-content")(11,"table",3),p(12,4),m(13,ee,2,0,"th",5)(14,te,2,1,"td",6),u(),p(15,7),m(16,ne,2,0,"th",5)(17,ie,3,3,"td",6),u(),p(18,8),m(19,ae,2,0,"th",5)(20,re,4,1,"td",6),u(),m(21,oe,1,0,"tr",9)(22,ce,1,0,"tr",10)(23,se,3,0,"tr",11),a()()()()),n&2&&(c(6),s("disabled",o.activeInsurances.length===0||o.isLoading),c(5),s("dataSource",o.activeInsurances),c(10),s("matHeaderRowDef",o.displayedColumns),c(),s("matRowDefColumns",o.displayedColumns))},dependencies:[E,T,H,A,L,k,R,O,P,y,K,N,$,z,B,F,Y,V,j,q,G,J,U,Q,f],styles:[".expired-container[_ngcontent-%COMP%]{max-width:800px;margin:20px auto}mat-card[_ngcontent-%COMP%]{padding:0}mat-card-header[_ngcontent-%COMP%]{background-color:#f5f5f5;padding:16px;display:flex;align-items:center}.spacer[_ngcontent-%COMP%]{flex:1 1 auto}mat-card-content[_ngcontent-%COMP%]{padding:16px}table[_ngcontent-%COMP%]{width:100%}.expired-insurances[_ngcontent-%COMP%]{text-decoration:line-through;color:#757575}.mat-column-actions[_ngcontent-%COMP%]{width:80px;text-align:center}.mat-column-time[_ngcontent-%COMP%]{width:120px}.mat-column-date[_ngcontent-%COMP%]{width:150px}tr.mat-mdc-row[_ngcontent-%COMP%]:hover{background:#f5f5f5}.mat-mdc-no-data-row[_ngcontent-%COMP%]{text-align:center;font-style:italic;color:#757575;padding:16px 0}"]})};export{X as ExpiredComponent};
